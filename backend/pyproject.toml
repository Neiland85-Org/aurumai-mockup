[tool.ruff]
line-length = 88
target-version = "py311"

[tool.ruff.lint]
select = ["E", "F", "W", "C90", "I", "N", "UP", "YTT", "S", "BLE", "FBT", "B", "A", "COM", "C4", "DTZ", "T10", "DJ", "EM", "EXE", "FA", "ISC", "ICN", "G", "INP", "PIE", "T20", "PYI", "PT", "Q", "RSE", "RET", "SLF", "SLOT", "SIM", "TID", "TCH", "INT", "ARG", "PTH", "ERA", "PD", "PGH", "PL", "TRY", "FLY", "NPY", "AIR", "PERF", "FURB", "LOG", "RUF"]
ignore = [
    "N818",  # Exception names ending in "Exception" - we use this convention for consistency
    "ANN201", # Missing return type annotation for public function - some overrides don't need this
    "ANN003", # Missing type annotation for **kwargs - some overrides don't need this
    "INP001", # File is part of an implicit namespace package - common in our structure
    "UP035",  # Import from collections.abc instead - too many changes
    "UP006",  # Use dict instead of Dict for type annotation - too many changes
    "UP007",  # Use X | Y for type annotations - too many changes
    "COM812", # Trailing comma missing - style preference
    "E501",   # Line too long - we have 88 char limit
    "PLR2004", # Magic value used in comparison - too many false positives
    "DTZ003", # datetime.utcnow() not allowed - too many changes
    "TRY400", # Use logging.exception instead of logging.error - style preference
    "G004",   # Logging statement uses f-string - we use f-strings for logging
    "BLE001", # Do not catch blind exception - too restrictive for our use cases
    "EM101",  # Exception must not use a string literal - too restrictive
    "TRY003", # Avoid specifying long messages outside exception class - style preference
    "TCH001", # Move application import into type-checking block - too many changes
    "TCH002", # Move third-party import into type-checking block - too many changes
    "TCH003", # Move standard library import into type-checking block - too many changes
    "PIE790", # Unnecessary pass statement - style preference
    "RET504", # Unnecessary assignment before return - style preference
    "RET505", # Unnecessary else after return - style preference
    "FBT001", # Boolean-typed positional argument - too restrictive
    "FBT002", # Boolean default positional argument - too restrictive
    "PLR0913", # Too many arguments in function definition - reasonable for our domain
    "C901",   # Function is too complex - reasonable for our domain logic
    "PLR0912", # Too many branches - reasonable for our domain logic
    "ARG001", # Unused function argument - sometimes needed for interface compliance
    "ARG002", # Unused method argument - sometimes needed for interface compliance
    "S311",   # Standard pseudo-random generators not suitable for crypto - false positive for mocks
    "PT004",  # Fixture does not return anything - our fixtures are for setup
    "ERA001", # Found commented-out code - we have some legacy comments
    "S104",   # Possible binding to all interfaces - needed for development
    "T201",   # print found - we have debug prints in config
    "SLF001", # Private member accessed - needed for internal functionality
    "S101",   # Use of assert detected - we use asserts in tests
    "PYI036", # __exit__ argument annotation - too restrictive for our use case
    "PGH003", # Use specific rule codes when ignoring type issues - style preference
    "SIM102", # Use single if instead of nested - style preference
    "SIM114", # Combine if branches - style preference
    "PLW2901", # for loop variable overwritten - rare case, acceptable
    "UP017",   # Use datetime.UTC alias - not available in Python 3.11
]

[tool.ruff.lint.per-file-ignores]
"__init__.py" = ["F401"]
"tests/**/*" = ["S101", "PLR2004"]
"alembic/versions/*" = ["E501"]
"services/*" = ["S311", "PLR2004"]  # Mock services use random generators
"api/routers/*_mock.py" = ["S311", "PLR2004"]  # Mock routers use random generators